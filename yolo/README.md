# YOLO Attacker

Hard-coded / bespoke attacker for 3D CAPTCHA project.

This repo contains two main pieces:

1. A **3D CAPTCHA synthetic dataset generator** (TypeScript + POV-Ray) that renders multi-view captchas and exports YOLO-format labels.
2. A **Python attacker pipeline** that:
   - Spoofs a browser profile (TLS + WebGL + UA),
   - Scrapes multiple views of a live CAPTCHA,
   - Runs a trained YOLO model on all views,
   - Infers which character is repeated, and
   - Submits the answer via Selenium.


## Project Structure

```text
yolo/
.
├── dataset
│   └── captcha.yaml              # YOLO dataset config (generated by TS script)
├── src
│   ├── gen_img                   # Synthetic dataset generator (TypeScript + POV-Ray)
│   │   ├── captcha.ts
│   │   ├── captchaService.ts
│   │   ├── generateDataset.ts
│   │   └── renderService.ts
│   ├── local                     # Browser automation + spoofing
│   │   ├── environment
│   │   │   ├── __init__.py
│   │   │   ├── selenium_wrapper.py
│   │   │   ├── tls_wrapper.py
│   │   │   └── webgl_spoof.py
│   │   ├── interactions
│   │   │   ├── __init__.py
│   │   │   └── mouse_movement.py # find_box(), validate(), etc.
│   │   ├── profiles
│   │   │   ├── __init__.py
│   │   │   ├── profile_generator.py
│   │   │   └── profile.py
│   │   └── get_captcha_views.py  # Download multiple views of the live captcha
│   ├── yolo                      # YOLO training + inference helpers
│   │   ├── infer_session.py      # infer_repeated_char(...)
│   │   ├── train_yolo.py         # training entrypoint
│   │   └── verify_bboxes.py      # debug: draw YOLO boxes on images
│   └── start.py                  # main attacker entrypoint
├── yolo11s_model                 # YOLO training outputs
│   ├── ...
│   └── weights
│       ├── best.pt               # best trained weights
│       └── last.pt
├── out.txt
├── package.json                  # Node/TS dependencies + scripts
├── tsconfig.json
├── README.md
├── requirement.txt               # Python dependencies
└── yolo11s.pt                    # Pretrained YOLO11s backbone
```

## Requirements

- Node.js >= 18
- POV-Ray installed and available in PATH
- npm
- Python ≥ 3.10

Node dependencies:

    npm install

Python dependencies:

    pip install -r requirement.txt

## 1. Generate the Synthetic Dataset

    npm run generate

This will create:
```
dataset/
  images/{train,val}/*.png
  labels/{train,val}/*.txt
  captcha.yaml
```

Optional to quickly visualise YOLO bounding boxes / labels:

    python src/yolo/verify_bboxes.py


## 2. Train YOLO on the Dataset (preferably on GPU)

    python src/yolo/train_yolo.py

This writes the weights we want to: `yolo11s_model/weights/best.pt`

## 3. Run the Attack (Inference on Live CAPTCHA)

    python src/start.py

This will:

1. Generate a random browser profile.
2. Launch a Selenium browser with spoofed TLS / WebGL.
3. Load the target CAPTCHA page (e.g. `https://group4.kokax.com/`).
4. Download multiple CAPTCHA views with different (rotX, rotY) combbinations for the current session using `get_captcha_views.py`
5. Call infer_repeated_char(...) to:
    - Run YOLO on all views,
    - Aggregate detections across images,
    - Decide which character is duplicated.
6. Automatically type the answer into the input box and validate.